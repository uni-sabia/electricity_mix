---
title: "Has renewables overtaken fossil fuels in Britain's electricity in 2020?"
author: "Uni Lee"
date: "1/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(lubridate)
library(gt)
library(ggplot2)
library(ggrepel)
library(scales)
options(scipen=999)
```

# The end of coal in Britain: How did they get there and who awaits at the end of the coal tunnel?

The Great Britain is daring greatly toward the end of the coal era. Only two years after the government's official commitment to coal phase-out,[Britain's electricity sector reportedly went two months without coal power](https://www.bbc.com/news/science-environment-52973089). Regarding Britain's coal phase-out, many questions arise:

* Has renewables surpassed coal in 2020?
* What led to the decline of coal? What are some historical trends? 
* How has other sources of electricity flared in comparison to coal? Can the growth of renewables pace with the rate of decline of coal? 
* Has the decline of coal power contributed to reducing carbon emissions in Britain?

# Data

[Grid Watch](http://gridwatch.templar.co.uk/) provides data on electricity demand and supply in Britain by energy source. We will analyze this dataset to answer these questions. To answer the last question, we will utilize carbon emissions data from [Our World in Data](https://github.com/owid/co2-data).

## Data Cleaning

```{r}
# Load dataset from Grid Watch 
elec_raw <- read.csv("data/gridwatch.csv")

## Extract years from the time data
elec_raw$year <- year(ymd_hms(elec_raw$timestamp))

## Calculate total output of all energy sources. We sum the capacities of pumped, hydro, oil, ocgt sources because they are negligible.
elec_raw <- elec_raw %>% mutate(
  renewable = wind + solar + biomass,
  other = pumped + hydro + oil + ocgt)

## Select variables of interest. We rename "ccgt" variable to "gas" for easy use of terms. We consider wind, solar, biomass as one category (renewable).
elec <- elec_raw %>% select(id, year, coal, nuclear, ccgt, renewable, other) %>% rename(gas=ccgt)

## Check for missing values 
colSums(is.na(elec))

# Load dataset from Our World in Data, select Britain, filter by year, select variables of interest 
co2_raw <- read.csv("data/owid-co2-data.csv") %>% filter(country=="United Kingdom", year > 2010) %>% select(year, co2, co2_growth_prct, coal_co2)

```

## Data Wrangling 

In the Grid Watch dataset, the unit of measurement for electricity output from each source is in GW. In other words, each value represents the total capacity of all power generators by source that was active at one point in time. For the purpose of analysis, we will take the yearly average of the active capacity by source. 

```{r}
# Pivot the dataset longer and calculate yearly average by source.
elec_long <- elec %>% pivot_longer(cols=coal:other,
                              names_to="source",
                              values_to="output") %>% filter(year!=2021)
elec_calc <- elec_long %>% 
  group_by(year, source) %>% 
  summarize(output = round(mean(output),2) ) %>% arrange(desc(year)) %>% as.data.frame()
```


# Has renewables surpassed coal in 2020?


```{r}
mix_2020 <- elec_calc %>% filter(year==2020) %>% select(-year) %>%
  mutate(share=round(output/sum(output)*100,2)) %>% arrange(share) 
mix_2020

gt(mix_2020) %>% tab_header(
  title="Britain's Electricity Mix in 2020") %>% tab_source_note(
  source_note = "Source: Grid Watch"
) %>% cols_label(
  source="Energy",
  output="Output (MW)",
  share = "Share in %"
)

```


In 2020, coal power produced only `r mix_2020[1,3]`% of Britain's electricity. Britain is indeed on its way to phasing out of coal power. On the other hand, renewables are on the rise, accounting for `r mix_2020[4,2]`% of the energy mix. However, as gas production remains dominant, energy production from renewables is still lower than fossil fuels. 

# What led to the decline of coal?  

The decline of coal power in Britain was already underway well before the government's announcement of coal phase-out commitment in 2018. After reaching its peak in 2012, coal started rapidly declining, as the graph below demonstrates. According to [Carbon Brief](https://www.carbonbrief.org/countdown-to-2025-tracking-the-uk-coal-phase-out), 8.4GW of coal power plants have closed since 2010. Closure of the last coal power station in Britain is scheduled in 2025. 

The decline of coal can be attributed to tightened regulations for air pollution control and tackling climate change. Of particular influence was imposing [carbon tax](https://www.ft.com/content/a05d1dd4-dddd-11e9-9743-db5a370481bc) on companies that produce electricity from fossil fuels in 2013. In addition, all new coal power plants were required to be equipped with carbon capture and storage (CCS) system, which is prohibitively expensive. The carbon tax and CCS requirement led to the loss of business case for coal. 


```{r}
coal <- elec_calc %>% filter(source=="coal")
coal$year <- as.integer(coal$year)

ggplot(coal, aes(x=year, y=output)) + geom_area(alpha=0.5) +
  labs(title = "Change in Coal Power Generation 2011-2020",
        y="Output in MW") +
    theme_minimal() + 
  theme(axis.title.x=element_blank()) + 
  geom_point(alpha=0.4) +
  geom_text_repel(aes(label=output)) +   
  scale_x_continuous(breaks=pretty_breaks())


```


### 3. How has other sources of electricity flared in comparison to coal? Can the growth of renewables pace with the rate of decline of coal?  

General overview of change in electricity output of all data sources shows that the production of electricity from coal has dropped significantly over the years. However, growth of renewables (solar, wind, biomass) is slower than the pace of coal's decline. Instead, gas has replaced coal, accounting for `r mix_2020[5,3]` % of the energy mix. Especially in 2020, wind power Meanwhile, nuclear power generation shows slow decline, taking up `r mix_2020[3,3]`% of the energy mix. 

```{r}
# Factorize energy sources for plotting
elec_calc$source <- factor(elec_calc$source, levels=c("coal","renewable", "gas", "nuclear", "other"))

# Plot change in energy output by source 
ggplot(elec_calc, aes(x=year, y=output, fill=source)) +
  geom_area(alpha=0.8) +
  labs(title="Change in electricity output by source (2011-2021)",
       x="Year", y="Yearly average output (MW)") +
  theme_light() +
  ylim(0,40000)

```

# Has the decline of coal power contributed to reducing carbon emissions in Britain?

```{r}
# Combine the dataset on co2 with coal production dataset and pivot it longer for graphing purpose
#co2 <- merge(co2_raw, coal, by="year") %>% select(-source) %>% 
#  rename(coal_output = output) 



















# graph trends 
ggplot(co2, aes(x=year, y=value, color=variable)) + 
  geom_line()

```


# References 

BBC, 2019. _Energy Briefing_. Accessed on 03.01.2021. Retrieved from https://news.files.bbci.co.uk/include/newsspec/pdfs/bbc-briefing-energy-newsspec-25305-v1.pdf

Grid Watch, 2021. _G.B. National Grid Status._ Viewed 03.01.2021. \<http://gridwatch.templar.co.uk/\>

Our World in Data, 2020. _Data on CO2 and Greenhouse Gas Emissions by Our World in Data_ Viewed 03.01.2021. \<https://github.com/owid/co2-data\>

https://www.ft.com/content/a05d1dd4-dddd-11e9-9743-db5a370481bc





